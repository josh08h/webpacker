const { join } = require('path')
const { cache_path: cachePath } = require('../config')

// Compile standard ES features for JS in node_modules with Babel.
module.exports = {
  test: /\.js$/,
  use: [
    {
      loader: require.resolve('babel-loader'),
      options: {
        babelrc: false,
        compact: false,
        // Compile standard ES features
        presets: [['@babel/env', { modules: false }]],
        cacheDirectory: join(cachePath, 'babel-loader-node-modules'),
        highlightCode: true
      }
    }
  ]
}
